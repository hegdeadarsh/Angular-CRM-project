<div>
    <div class="container"></div>
    <h3 style="text-align: center;"><strong>CALL TICKET SCREEN</strong></h3><br>
    <div class="col-md-12 row">
        <div class="col-md-4">
            <table class="table table-bordered table-with-bold-lines">
                <tr>
                    <td colspan="4">
                        <div class="row">
                            <div class="col-md-8">
                        <ng-select [items]="customerList" [bindLabel]="'companyName'" [(ngModel)]="selectedCustomer"
                            (change)="onSelectCustomer($event)">
                        <ng-option value="" disabled>Select Customer</ng-option>
                        </ng-select>
                    </div><div class="col-md-4">
                        <input class="form-control" type="number" name="machineNumber" [(ngModel)]="machineNumber" placeholder="Machine No" (change)="onChangeMachineNo()">
                    </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <p *ngIf="companyName == null">Address 1</p>
                        <p *ngIf="companyName != null"><b> {{addressOne}}</b></p>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <p *ngIf="companyName == null">Address 2</p>
                        <p *ngIf="companyName != null"><b>{{addressTwo}}</b></p>
                    </td>
                </tr>
                <tr>
                    <td colspan="4">
                        <p *ngIf="companyName == null">Address 3</p>
                        <p *ngIf="companyName != null"><b>{{addressThree}}</b></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>City</p>
                    </td>
                    <td>
                        <p><b>{{city}}</b></p>
                    </td>
                    <td>
                        <p>Pin</p>
                    </td>
                    <td>
                        <p><b>{{pincode}}</b></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>State</p>
                    </td>
                    <td>
                        <p><b>{{state}}</b></p>
                    </td>
                    <td>
                        <p>Zone</p>
                    </td>
                    <td>
                        <p><b>{{zone}}</b></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>Cluster</p>
                    </td>
                    <td>
                        <p><b>{{cluster}}</b></p>
                    </td>
                    <td>
                        <p>Route</p>
                    </td>
                    <td><b>{{routeNo}}</b></td>
                </tr>
            </table>
        </div>
        <div class="col-md-8" style="overflow: auto; height: 230px;">
            <table class="table table-bordered table-with-bold-lines">
                <tr style="text-align: center;">
                    <th style="width: 1%;">SNo</th>
                    <th style="width: 1%;">Select</th>
                    <th style="width: 5%;">Ticket No.</th>
                    <th style="width: 3%;">M/c no</th>
                    <th style="width: 3%;">Model</th>
                    <th style="width: 7%;">Status</th>
                    <th style="width: 4%;">Start Dt</th>
                    <th style="width: 4%;">End Dt</th>
                    <th style="width: 3%;">Inv No</th>
                    <th style="width: 4%;">Inv Dt</th>
                    <th style="width: 4%;">Inv Value</th>
                </tr>
                <!-- let abc of perticularCustomerInvoiceData ; let tickets of customerTicketList; -->
                <tr *ngFor="let machine of MachineTicketList ;  let i = index"
                    [style.background-color]="isRowSelected(machine.machineNumber) ? 'lightblue' : 'white'">
                    <td style="text-align: right;">{{(i+1)}}</td>
                    <td class="hover-text" (click)="onRowClick(machine)" style="cursor: pointer;"></td>
                    <td style="text-align: right;">{{machine.tokenNo}}</td>
                    <td style="text-align: right;">{{machine.machineNumber}}</td>
                    <td>{{machine.modelName}}</td>
                    <td>{{machine.invoicePerticular}}</td>
                    <td>{{machine.warrantyFrom | date}}</td>
                    <td>{{machine.warrantyTill | date}}</td>
                    <td style="text-align: right;">{{machine.invoiceNumber}}</td>
                    <td style="text-align: right;">{{machine.invoiceDate | date}}</td>
                    <td style="text-align: right;">{{machine.invoiceAmount}}</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="col-md-12 row">
        <div class="col-md-3">
            <table class="table table-bordered table-with-bold-lines">
                <tr>
                    <td>GST</td>
                    <td colspan="3" style="width: 65%;"><b>{{gstin}}</b></td>
                </tr>
                <tr>
                    <td>Weekly Off</td>
                    <td colspan="2"><b>{{weeklyOff}}</b></td>
                </tr>
                <tr>
                    <td>Working Hrs</td>
                    <td><b>{{workingStart}}</b></td>
                    <td><b>{{workingEnd}}</b></td>
                </tr>
                <tr>
                    <td>Security Req</td>
                    <td colspan="2"><b>{{securityFormalities}}</b></td>
                </tr>
            </table>
        </div>
        <div class="col-md-1">
        </div>
        <div class="col-md-7">
            <div class="flex-column align-items-center">
                <div class="col-md-12 row">
                    <div class="col-md-12" style="overflow: auto; height: 150px;">
                        <table class="table table-bordered table-with-bold-lines">
                            <tr>
                                <td style="text-align: center; padding: 0px;" colspan="6">
                                    <h4>Contact Persons</h4>
                                </td>
                            </tr>
                            <tr class="sticky-header" style="text-align: center;">
                                <th style="width: 5%;">SNo</th>
                                <th>Sal</th>
                                <th>Name</th>
                                <th style="width: 20%;">Mobile</th>
                                <th style="width: 37%;">Email</th>
                                <th>Designation</th>
                            </tr>
                            <tr *ngFor="let details of contactDetails; let i = index"
                                [style.background-color]="isSelectedRow(details.id) ? 'lightblue' : 'white'">
                                <td style="cursor: pointer;text-align: right;" (click)="onClickRow(details)"
                                    class="hover-text">{{(i+1)}}</td>
                                <td style="text-align: left;">{{details.salute}}</td>
                                <td style="text-align: left;">{{details.contactName}}</td>
                                <td style="text-align: right;">{{details.mobile}}</td>
                                <td style="text-align: left;">{{details.email}}</td>
                                <td style="text-align: left;">{{details.designation}}</td>
                            </tr>
                        </table>
                    </div>
                    <div *ngIf="machineSelected" class="col-md-12" style="overflow: auto;">
                        <table class="table table-bordered table-with-bold-lines">
                            <!-- <tr>
                                <td style="text-align: center; padding: 0px;" colspan="6">
                                    <h5>Add Contact Persons</h5>
                                </td>
                            </tr> -->
                            <tr class="sticky-header" style="text-align: center;">
                                <th style="width: 5%;"><input placeholder="Sal" class="form-control" type="text"
                                        id="salute" name="salute" [(ngModel)]="salute" required></th>
                                <th style="width: 20%;"><input placeholder="Name" class="form-control" type="text"
                                        id="contactname" name="contactname" [(ngModel)]="contactname" required></th>
                                <th style="width: 13%;"><input placeholder="Mobile" class="form-control" id="mobile"
                                        name="mobile" [(ngModel)]="mobile" required></th>
                                <th style="width: 40%;"><input placeholder="Email" class="form-control" id="email"
                                        name="email" [(ngModel)]="email" required></th>
                                <th style="width: 30%;"> <input placeholder="Designation" class="form-control"
                                        id="designation" name="designation" [(ngModel)]="designation" required></th>
                                <th style="width: 5%;"><button class="form-control" type="submit"
                                        class="btn btn-primary" (click)="addContactDetails()">Add</button>
                                </th>
                            </tr>
                        </table>
                    </div>
                    <!-- <div class="col-md-12 row" *ngIf="machineSelected">
                        <h5>
                            <hr>Add Contact:
                        </h5>&nbsp;
                        <div class="col-md-1">
                            <label for="machineNumber"><strong>Salute:</strong></label>
                            <input style="width: 50%;" class="form-control" type="text" id="salute" name="salute" [(ngModel)]="salute"
                                required>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-2">
                            <label for="machineNumber"><strong>Contact Name:</strong></label>
                            <input style="width: 115%;" class="form-control" type="text" id="contactname" name="contactname"
                                [(ngModel)]="contactname" required>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-1">
                            <label for="address1"><strong>Designation:</strong></label>
                            <input style="width: 80%;" class="form-control" id="designation" name="designation" [(ngModel)]="designation"
                                required>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-2">
                            <label for="address1"><strong>Email:</strong></label>
                            <input style="width: 150%;" class="form-control" id="email" name="email" [(ngModel)]="email" required>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-2">
                            <label for="address1"><strong>Mobile:</strong></label>
                            <input style="width: 100%;" class="form-control" id="mobile" name="mobile" [(ngModel)]="mobile" required>
                        </div>
                        <div class="col-md-1">
                    <br> <button class="form-control" type="submit" class="btn btn-primary" (click)="addContactDetails()">Add</button>
                </div>
                    </div> -->
                </div>
            </div>
        </div>
        <!-- <div class="col-md-1"><br><br><br><br>
            <br><button class="form-control" type="submit" class="btn btn-primary" (click)="addContactDetails()">Save
                Contact</button>
        </div> -->
    </div>
</div>
<div style="background-color: rgb(223, 223, 223); padding: 15px">
    <div class="col-md-12 row">
        <div class="col-md-3">
            <table class="table table-bordered table-with-bold-lines">
                <tr>
                    <td style="width: 5%;">Date:</td>
                    <td style="text-align: center;width: 10%;"><b>
                        <!-- {{value | date:'dd MMM yyyy'}} -->
                    <input type="date" [(ngModel)]="value">
                    </b></td>
                    <td style="width: 5%;">Time:</td>
                    <td style="text-align: center;width: 10%;"><b>{{ systemTime | async | date: 'HH:mm:ss' }}</b></td>
                </tr>
            </table>
        </div>
        <!-- <div class="col-md-2">
            <button class="btn btn-primary" (click)="startTimer()">Start Timer</button>
            &nbsp;&nbsp;&nbsp;
            <button class="btn btn-primary" (click)="endTimer()">End Timer</button>
        </div> -->
        <div class="col-md-2">
            <table class="table table-bordered table-with-bold-lines">
                <tr>
                    <td>Ticket No.</td>
                    <!-- <td style="width: 60%;"><input *ngIf="ticketNo != null" style="text-align: right;" type="text"
                            name="Machine" [(ngModel)]="ticketNo" class="form-control" readonly> -->
                    <td>
                        <!-- <input *ngIf="ticketNo == null" style="text-align: right;" type="text" name="Machine"
                            [(ngModel)]="newTicketNo" class="form-control" readonly> -->
                        <p *ngIf="ticketNo != null"><b>{{ticketNo}}</b></p>
                        <p *ngIf="ticketNo == null"><b>{{newTicketNo}}</b></p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="col-md-2"></div>
        <div *ngIf="this.ticketNo != null" class="col-md-1">
            <button class="btn btn-primary" style="height: 38px;width: 130px;" data-toggle="modal"
                data-target="#myModalFollowup" (click)="Done()">Ticket - clear
            </button>
        </div>

        <button class="btn btn-primary" style="height: 38px;width: 130px;" (click)="saveRequest()">To
            Workfront</button>
        <!-- <div class="col-md-12 row">
            <div class="col-md-9"></div>
            <div class="col-md-3">
                <button class="btn btn-primary" style="height: 65px;width: 130px;" data-toggle="modal" data-target="#myModalFollowup" (click)="Done()">Done - clear
                </button>
                &nbsp; &nbsp;
                <button class="btn btn-primary" style="height: 65px;width: 130px;" (click)="saveRequest()">To
                    Workfront</button><br>
            </div>
            <div class="col-md-1"></div>
        </div> -->
        <div class="col-md-1"></div>
    </div>
    <div class="col-md-12" style="overflow: auto; height: 150px;">
        <table class="table table-bordered table-with-bold-lines">
            <tr class="sticky-header" style="text-align: center;">
                <th style="width: 2%;">SN</th>
                <th style="width: 5%;">Date</th>
                <th style="width: 5%;">Start Time</th>
                <th style="width: 5%;">End Time</th>
                <th style="width: 5%;">Log by</th>
                <th style="width: 12%;">Cust Call From</th>
                <th>Fault/Issue</th>
                <th>Resolution</th>
                <th>Entered Priority</th>
            </tr>
            <tr *ngFor="let ticket of ticketDetailsList; let i = index">
                <td>{{(i+1)}}</td>
                <td style="width: 5%;">{{ticket.createdOn | date:'dd MMM yyyy'}}</td>
                <td style="width: 5%;">{{ticket.startTime | date:'HH:mm:ss' }}</td>
                <td style="width: 5%;">{{ticket.endTime | date:'HH:mm:ss' }}</td>
                <td>{{ticket.createdBy}}</td>
                <td>{{ticket.callFrom}}</td>
                <td>{{ticket.remarks}}</td>
                <td>{{ticket.resolution}}</td>
                <td>{{ticket.requestFor}}</td>
            </tr>
        </table>
    </div>
    <div class="col-md-12">
        <table class="table table-bordered table-with-bold-lines">
            <tr>
                <td style="width: 2%;"></td>
                <td style="width: 5%;">{{value | date:'dd MMM yyyy'}}</td>
                <td style="width: 5%;">{{valuetime | date:'HH:mm:ss' }}</td>
                <td style="width: 5%;">{{endTime | date:'HH:mm:ss' }}</td>
                <td style="width: 5%;">{{userName}}</td>
                <td style="width: 12%;">{{contactName}}</td>
                <td style="width: 20%;">
                    <h6>Fault/Issue</h6><textarea type="text" name="fault" [(ngModel)]="fault"
                        class="form-control"></textarea>
                </td>
                <td style="width: 20%;">
                    <h6>Resolution</h6><textarea type="text" name="resolution" [(ngModel)]="Resolution"
                        class="form-control"></textarea>
                </td>
                <td style="z-index:9999;">
                    <div class="col-md-12 row">
                        <div class="col-md-6">
                            <label for="unit"><strong>Tele Support:</strong></label>
                            <ng-select [items]="teleSupportrequestslist" name="requestsName"
                                [(ngModel)]="selectedrequestt" [multiple]="true" placeholder="Select Options"
                                (change)="onSelectRequest()">
                            </ng-select>
                        </div>
                        <div class="col-md-6">
                            <label for="unit"><strong>Field Visit:</strong></label>
                            <ng-select [items]="fieldVisitRequestslist" name="requestsName"
                                [(ngModel)]="selectedrequestf" [multiple]="true" placeholder="Select Options"
                                (change)="onSelectRequest()">
                            </ng-select>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <!-- <div class="col-md-12 row">
        <div class="col-md-12 row">
            <table class="table table-bordered table-with-bold-lines">
                <tr>
                    <td style="width: 2%;"></td>
                    <td style="width: 8%;">{{value | date:'dd MMM yyyy'}}</td>
                    <td style="width: 8%;">{{value | date:'HH:mm:ss' }}</td>
                    <td style="width: 8%;">{{endTime | date:'HH:mm:ss' }}</td>
                    <td style="width: 5%;">{{userName}}</td>
                    <td style="width: 12%;">{{contactName}}</td>
                    <td>
                        <h6>Fault/Issue</h6><input type="text" name="fault" [(ngModel)]="fault" class="form-control">
                    </td>
                    <td>
                        <h6>Resolution</h6><input type="text" name="resolution" [(ngModel)]="Resolution"
                            class="form-control">
                    </td>
                    <td>
                        <div class="col-md-12 row">
                            <div class="col-md-6">
                                <label for="unit"><strong>Tele Support:</strong></label>
                                <ng-select [items]="teleSupportrequestslist" name="requestsName"
                                    [(ngModel)]="selectedrequestt" [multiple]="true" placeholder="Select Options"
                                    (change)="onSelectRequest()">
                                </ng-select>
                            </div>
                            <div class="col-md-6">
                                <label for="unit"><strong>Field Visit:</strong></label>
                                <ng-select [items]="fieldVisitRequestslist" name="requestsName"
                                    [(ngModel)]="selectedrequestf" [multiple]="true" placeholder="Select Options"
                                    (change)="onSelectRequest()">
                                </ng-select>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </div> -->
</div>
<br><br><br>
<div class="container">
    <div class="modal fade" id="myModalFollowup" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title custom-title">Clear the Ticket number - {{ticketNo}} </h4>
                </div>
                <div class="modal-body">
                    <div class="col-md-12 row">
                        <div class="col-md-5">
                            <label for="unit"><b>Customer Name :</b>
                                {{companyName}}</label>
                        </div>
                        <div class="col-md-5">
                            <label for="unit"><b>Machine Number :</b>
                                {{selectedMachine}}</label>
                        </div>
                        <div class="col-md-2">
                            <label for="unit"><b>Model:</b>
                                {{modelName}}</label>
                        </div>
                    </div><br>
                    <div class="col-md-12 row">
                        <div class="col-md-5">
                            <label for="unit"><b>Region :</b>
                                {{region}}</label>
                        </div>
                        <div class="col-md-5">
                            <label for="unit"><b>Zone :</b> {{zone}}</label>
                        </div>
                        <div class="col-md-2">
                            <label for="unit"><b>RequestFor:</b>
                                {{requestForName}}</label>
                        </div>
                    </div>
                    <div class="col-md-12 row">
                        <div class="col-md-5">
                            <label for="unit"><b>Remarks :</b>
                                {{fault}}</label>
                        </div>
                    </div><br>
                    <div class="col-md-12 row">
                        <div class="col-md-5">
                            <label for="unit" style="width: 90%;"><b>Date Of
                                    Interaction:</b></label>
                            <input type="date" name="dateOfInteraction" [(ngModel)]="dateofinteraction"
                                class="form-control" placeholder="Select Interacted Date">
                        </div>
                        <div class="col-md-5">
                            <label for="unit"><b>Attended <br>By
                                    :</b></label>
                            <select (change)="onSelectAttendedBy($event)" class="form-control">
                                <option value="">Select Person</option>
                                <option *ngFor="let users of usersList" value={{users.id}}>
                                    {{users.userName}}
                                </option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <label for="unit"><b>Attended How:</b></label>
                            <select (change)="onSelectAttendedHow($event)" class="form-control" style="width: 100px;">
                                <!-- Adjust the width value as needed -->
                                <option value="">Select Type Of Interaction
                                </option>
                                <option *ngFor="let attendtype of attendtypelist" [value]="attendtype.attendTypeId">
                                    {{attendtype.attendTypeName}}
                                </option>
                            </select>
                        </div>
                    </div><br><br>
                </div>
                <div class="modal-footer" style="display: flex; justify-content: center; align-items: center;">
                    <button type="button" class="btn btn-success" data-dismiss="modal"
                        style="background-color: rgb(27, 9, 129);" (click)="savedoneDetails()">DONE</button>
                </div>
            </div>
        </div>
    </div>
</div>